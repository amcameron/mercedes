<!doctype html>
<!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

	<title>Mercedes</title>
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<meta name="description" content="">
	<link rel="stylesheet" href="css/styles.css">
	<link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
	
</head>

<style>
#video_box{
    float:left;
}
#video_overlays {
position:absolute;
float:left;
    width:640px;
    height:37px;
    background-color:rgba(255,0,0,0.5);
    z-index:300000;
}
button {
	color: black !important;
}
video {
	-moz-transform: scale(1, 1) !important;
-webkit-transform: scale(1, 1) !important;
-o-transform: scale(1, 1) !important;
transform: scale(1, 1) !important;
}
</style>

<body style='background-color: #444;'>
<div class="site-wrapper">

	<div class="site-wrapper-inner">

		<div class="cover-container container">

		<center><p style="float: left;">Frame: &nbsp;</p> <p style="float: left;" id="time">0</p></center><br/><br/>
		
		<div id="video_box">
		<div id="video_overlays">No blink detected</div>
		<video id="v0" controls tabindex="0" autobuffer preload style="">
<!-- 		    <source type="video/webm; codecs=&quot;vp8, vorbis&quot;" src="lab0.webm"></source>
		    <source type="video/ogg; codecs=&quot;theora, vorbis&quot;" src="http://www.html5rocks.com/tutorials/video/basics/Chrome_ImF.ogv"></source>
		    <source type="video/mp4; codecs=&quot;avc1.42E01E, mp4a.40.2&quot;" src="http://www.html5rocks.com/tutorials/video/basics/Chrome_ImF.mp4"></source> -->
		    <p>Sorry, your browser does not support the &lt;video&gt; element.</p>
		</video>
		</div>
		<br/><Br/>
		        <button id="speed">+1</button>
		        <button id="negative">-1</button>
		        <button id="blink">Blink</button>
		        <button id="notblink">Not Blink</button>
		        <br/>
		<div id="an" style="word-wrap: break-word;"></div>


		<script>
		var vid = $('#v0')[0];

		var readyUp = window.setInterval(function(t){
		  if (vid.readyState > 0) {
		    doEverything();
		  }
		},500);

		var url = window.location.href;

		if(url.split("video=")[1]){
			$(vid).hide();
			var video = document.createElement('video');
			video.src = url.split("video=")[1];
			$(video).attr("controls","").attr("width","640");
			$("#video_box").append(video);
			vid = video;
		}


		function doEverything(){
		clearInterval(readyUp);
		var fps = 25;
		var num = Math.round(vid.duration*fps);
		var annotation = new Array(num);

		for (var i = 0; i < num; i++) annotation[i] = "No blink detected";

		window.theInterval;   
		vid.onplay = vid.onclick = function() {
		    // vid.onplay = vid.onclick = null;


		    // setTimeout(function() {
		    //     vid.pause();
		    //     window.theInterval = setInterval(function() {

		    //             vid.currentTime += (1 / fps);
		    //             console.log(vid.currentTime);

		    //     }, 2000);
		    // }, 12000);
		    
		    setInterval(function() {
		        $('#time').html(Math.round(vid.currentTime * fps));
		        $("#video_overlays").html(annotation[(Math.round(vid.currentTime * fps) / fps)*fps]);
		    }, 100);
		};

		vid.onmouseup = function(){
			clearInterval(window.theInterval);
		}

		$("#speed").click(function() { // button function for 3x fast speed forward
		    vid.pause();
		    vid.currentTime += (1 / fps);
		    clearInterval(window.theInterval);
		});
		$("#negative").click(function() { // button function for rewind
		    vid.pause();
		    vid.currentTime -= (1 / fps);
		    clearInterval(window.theInterval);
		});

		$("#blink").click(function(){ 
		    annotation[(Math.round(vid.currentTime * fps) / fps)*fps] = "Blink detected!";
		    $("#video_overlays").html("Blink detected");
		    clearInterval(window.theInterval);
		});
		$("#notblink").click(function(){ 
		    annotation[(Math.round(vid.currentTime * fps) / fps)*fps] = "No blink detected";
		    $("#video_overlays").html("No blink detected");
		    clearInterval(window.theInterval);
		});
		}
		</script>

		</div>

	</div>

</div>



</body>
</html> 
